{% extends "layout.html" %}
{% block title %}任务列表{% endblock %}
{% block content %}
<div class="page-header">
  <h1>任务列表</h1>
</div>

<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>ID</th>
      <th>标题</th>
      <th>截止日期</th>
      <th>状态</th>
    </tr>
  </thead>
  <tbody>
  {% for t in tasks %}
    <tr>
      <td>{{t.id}}</td>
      <td><a href="{{ url_for('get_task_info', id=t.id) }}">{{t.title}}</a></td>
      <td>{{t.deadline | format_from_utc}}</td>
      <td>
      {% if t.status == 'configuring' %}
        <span class="label label-default">配置中</span>
      {% elif t.status == 'published' %}
        <span class="label label-warning">进行中</span>
      {% elif t.status == 'ended' %}
        <span class="label label-success">已截止</span>
      {% endif %}
      {% if t.involved %}
        <span class="label label-danger">与我有关</span>
      {% endif %}
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>

{% if status in [0,1] %}
<form class="form-horizontal" method="post">
<fieldset>
<input type="hidden" name="status" value="{{status}}">
{% if status == 1 %}
  <div class="form-group">
    <label class="col-md-offset-2 col-md-4" for="confirm">
      <input id="confirm" type="checkbox" required>
      确认？
    </label>
  </div>
  <div class="form-group">
    <div class="col-md-offset-2 col-md-4">
      <button class="btn btn-primary">批量注册</button>
    </div>
  </div>
{% endif %}

<div class="form-group">
  <label class="col-md-2 control-label" for="category">入学年份</label>  
  <div class="col-md-2">
    <input id="category" name="category" type="text" placeholder="例如：2014" class="form-control input-md" {% if status==1 %}readonly{% endif %} value="{{category}}" required>
  </div>
</div>
<div class="form-group">
  <label class="col-md-2 control-label" for="category">用户信息</label>  
  <div class="col-md-9">
    <textarea id="text" name="text" class="form-control input-md" style="font-family: monospace;" rows="20" placeholder="格式：学号&#9;名字&#9;Email&#10;例如：&#10;5140309000&#9;张三&#9;szhang@example.com&#10;5140309666&#9;李四&#9;sli@sjtu.edu.cn" {% if status==1 %}readonly{% endif %} required>{{text}}</textarea>
  </div>
</div>

{% if status == 0 %}
  <div class="form-group">
    <div class="col-md-offset-2 col-md-4">
      <button class="btn btn-primary">提交</button>
    </div>
  </div>
{% endif %}
</fieldset>
</form>
{% endif %}

{% endblock %}